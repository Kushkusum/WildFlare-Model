{"files":[{"id":"b7b32447-515b-4db8-a7f7-17ca8b3c558a","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Kolkata\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"f8729d53-3270-4781-a8a3-22b4fd571c3c","name":"Code","type":"server_js","source":"function doGet(e) {\n  return ContentService.createTextOutput(\"Hello, your script is working!\");\n}\n\nfunction doPost(e) {\n  try {\n    const name \u003d Utilities.formatDate(new Date(), \u0027GMT+7\u0027, \u0027yyyyMMdd-HHmmss\u0027) + \u0027.jpg\u0027; // Change GMT+7 with GMT in your area.\n    const subFolderName \u003d Utilities.formatDate(new Date(), \u0027GMT+7\u0027, \u0027yyyyMMdd\u0027);\n    const folderName \u003d e.parameters.folder || \u0027ESP32-CAM Captures\u0027;\n    \n    // Logging the received parameters for debugging\n    Logger.log(\u0027Received folderName: \u0027 + folderName);\n    Logger.log(\u0027Received subFolderName: \u0027 + subFolderName);\n    \n    const data \u003d Utilities.base64Decode(e.postData.contents);\n    const blob \u003d Utilities.newBlob(data, \u0027image/jpg\u0027, name);\n\n    let folder;\n    const folders \u003d DriveApp.getFoldersByName(folderName);\n    if (folders.hasNext()) {\n      folder \u003d folders.next();\n    } else {\n      folder \u003d DriveApp.createFolder(folderName);\n    }\n\n    let subFolder;\n    const subFolders \u003d folder.getFoldersByName(subFolderName);\n    if (subFolders.hasNext()) {\n      subFolder \u003d subFolders.next();\n    } else {\n      subFolder \u003d folder.createFolder(subFolderName);\n    }\n\n    const file \u003d subFolder.createFile(blob);\n    Logger.log(\u0027File uploaded: \u0027 + file.getName());\n    \n    return ContentService.createTextOutput(\u0027Done\u0027);\n  } catch (error) {\n    Logger.log(\u0027Error: \u0027 + error);\n    return ContentService.createTextOutput(\u0027Error: \u0027 + error);\n  }\n}"}]}